@import "./new-settings";
@import "./mixins";

// VARIABLES
$block: #{$fd-namespace}-tree;

$fd-tree-item-padding-y: 0.25rem !default;
$fd-tree-item-height: 2.75rem !default;
$fd-tree-item-height-compact: 2rem !default;

$fd-tree-content-padding-right: 1rem !default;

$fd-tree-checkbox-margin-left: 0.688rem !default;
$fd-tree-checkbox-margin-left-compact: 0.5rem !default;

$fd-tree-checkbox-margin-right: 0.688rem !default;
$fd-tree-checkbox-margin-right-compact: 0.5rem !default;

$fd-tree-expander-height: 2.75rem !default;
$fd-tree-expander-height-compact: 1.5rem !default;
$fd-tree-expander-width: 2.75rem !default;
$fd-tree-expander-width-compact: 2rem !default;

// MIXINS
@mixin set-state(
  $background: var(--sapList_Background),
  $icon: var(--sapContent_IconColor),
  $text: var(--sapList_TextColor),
  $border: var(--sapList_BorderColor)) {
  background-color: $background;
  border-bottom: 0.063rem solid $border;

  .#{$block}__expander {
    color: $icon;
  }

  .#{$block}__text {
    color: $text;
  }
}

@mixin set-indentation($margin) {
  .#{$block}__expander {
    margin-left: $margin;
  }

  .#{$block}__expander + .#{$block}__text {
    margin: 0;
  }

  .#{$block}__form-item + .#{$block}__text,
  .#{$block}__text:only-child {
    margin-left: $margin + $fd-tree-expander-width;
  }

  @include fd-rtl() {
    .#{$block}__expander {
      margin-left: 0;
      margin-right: $margin;
    }

    .#{$block}__form-item + .#{$block}__text,
    .#{$block}__text:only-child {
      margin-left: 0;
      margin-right: $margin + $fd-tree-expander-width;
    }
  }
}

@mixin set-indentation-dependent-selection($margin) {
  .#{$block}__expander {
    margin-left: $margin;
  }

  .#{$block}__text {
    margin: 0;
  }

  .#{$block}__form-item:first-child {
    margin-left: $margin + $fd-tree-expander-width;
  }

  .#{$block}__form-item + .#{$block}__text {
    margin: 0;
  }

  @include fd-rtl() {
    .#{$block}__expander {
      margin-left: 0;
      margin-right: $margin;
    }

    .#{$block}__form-item + .#{$block}__text {
      margin: 0;
    }

    .#{$block}__form-item:first-child {
      margin-left: $fd-tree-checkbox-margin-right;
      margin-right: $margin + $fd-tree-expander-width;
    }
  }
}

.#{$block} {
  // BLOCK
  width: 100%;
  list-style-type: none;

  &[aria-hidden="true"] {
    display: none;
  }

  [class*=" level"] {
    .#{$block}__content {
      background-color: var(--sapList_AlternatingBackground);
      border-bottom-color: transparent;

      @include fd-hover() {
        @include set-state($background: var(--sapList_Hover_Background), $border: transparent);
      }

      @include fd-selected() {
        @include set-state($background: var(--sapList_SelectionBackgroundColor), $border: var(--sapList_SelectionBorderColor));

        @include fd-hover() {
          @include set-state($background: var(--sapList_Hover_SelectionBackground), $border: var(--sapList_SelectionBorderColor));
        }
      }
    }
  }

  &.level-1,
  &.level-25 {
    .#{$block}__form-item + .#{$block}__text,
    .#{$block}__text:only-child {
      margin-left: $fd-tree-expander-width;
    }

    .#{$block}__expander + .#{$block}__text {
      margin: 0;
    }

    @include fd-rtl() {
      .#{$block}__form-item + .#{$block}__text,
      .#{$block}__text:only-child {
        margin-left: 0;
        margin-right: $fd-tree-expander-width;
      }
    }

    &.#{$block}--dependent-selection {
      .#{$block}__text {
        margin: 0;
      }

      .#{$block}__form-item + .#{$block}__text {
        margin: 0;
      }

      .#{$block}__form-item:first-child {
        margin-left: $fd-tree-expander-width;
      }

      @include fd-rtl() {
        .#{$block}__form-item:first-child {
          margin-left: $fd-tree-checkbox-margin-right;
          margin-right: $fd-tree-expander-width;
        }

        .#{$block}__form-item + .#{$block}__text {
          margin: 0;
        }
      }
    }
  }

  &.expanded-level-1,
  &.expanded-level-25 {
    .level-2,
    .level-26 {
      @include set-indentation(1.5rem);
    }

    &.#{$block}--dependent-selection {
      .level-2,
      .level-26 {
        @include set-indentation-dependent-selection(1.5rem);
      }
    }
  }

  &.expanded-level-2,
  &.expanded-level-26 {
    .level-2,
    .level-26 {
      @include set-indentation(1rem);
    }

    .level-3,
    .level-27 {
      @include set-indentation(2.5rem);
    }

    &.#{$block}--dependent-selection {
      .level-2,
      .level-26 {
        @include set-indentation-dependent-selection(1rem);
      }

      .level-3,
      .level-27 {
        @include set-indentation-dependent-selection(2.5rem);
      }
    }
  }

  &.expanded-level-3,
  &.expanded-level-4,
  &.expanded-level-5 {
    @for $i from 2 through 6 {
      $marginLeft: ($i - 1) * 0.5rem;
      .level-#{$i} {
        @include set-indentation($marginLeft);
      }
    }

    &.#{$block}--dependent-selection {
      @for $i from 2 through 6 {
        $marginLeft: ($i - 1) * 0.5rem;
        .level-#{$i} {
          @include set-indentation-dependent-selection($marginLeft);
        }
      }
    }
  }

  &.expanded-level-27,
  &.expanded-level-28,
  &.expanded-level-29 {
    @for $i from 26 through 30 {
      $marginLeft: ($i - 25) * 0.5rem;
      .level-#{$i} {
        @include set-indentation($marginLeft);
      }
    }

    &.#{$block}--dependent-selection {
      @for $i from 26 through 30 {
        $marginLeft: ($i - 25) * 0.5rem;
        .level-#{$i} {
          @include set-indentation-dependent-selection($marginLeft);
        }
      }
    }
  }

  @for $i from 6 through 24 {
    &.expanded-level-#{$i} {
      @for $j from 2 through 24 {
        $marginLeft: ($j - 1) * 0.25rem;
        .level-#{$j} {
          @include set-indentation($marginLeft);
        }
      }

      &.#{$block}--dependent-selection {
        @for $j from 2 through 24 {
          $marginLeft: ($j - 1) * 0.25rem;
          .level-#{$j} {
            @include set-indentation-dependent-selection($marginLeft);
          }
        }
      }
    }
  }

  @for $i from 30 through 36 {
    &.expanded-level-#{$i} {
      @for $j from 25 through 36 {
        $marginLeft: ($j - 25) * 0.25rem;
        .level-#{$j} {
          @include set-indentation($marginLeft);
        }
      }

      &.#{$block}--dependent-selection {
        @for $j from 25 through 36 {
          $marginLeft: ($j - 25) * 0.25rem;
          .level-#{$j} {
            @include set-indentation-dependent-selection($marginLeft);
          }
        }
      }
    }
  }

  // ELEMENTS
  &__item {
    @include fd-reset();

    height: 100%;
  }

  &__content {
    @include fd-reset();
    @include fd-flex-vertical-center();
    @include set-state();

    height: $fd-tree-item-height;
    padding-right: $fd-tree-content-padding-right;

    @include fd-rtl() {
      padding-right: 0;
      padding-left: $fd-tree-content-padding-right;
    }

    @include fd-hover() {
      @include set-state($background: var(--sapList_Hover_Background));
    }

    @include fd-selected() {
      @include set-state($background: var(--sapList_SelectionBackgroundColor), $border: var(--sapList_SelectionBorderColor));

      @include fd-hover() {
        @include set-state($background: var(--sapList_Hover_SelectionBackground), $border: var(--sapList_SelectionBorderColor));
      }
    }
  }

  &__expander {
    @include fd-reset();

    width: $fd-tree-expander-width;
    height: $fd-tree-expander-height;

    @include fd-icon('navigation-right-arrow', 'default', 'after') {
      @include fd-flex-center();

      height: 100%;
      min-height: 100%;
      font-size: var(--sapFontLargeSize);
    }

    @include fd-rtl() {
      &::after {
        content: "\e067";
      }
    }

    &.is-expanded,
    &[aria-expanded="true"] {
      border-bottom: none;

      &::after {
        content: "\e1e2";
      }
    }
  }

  &__text {
    @include fd-reset();
    @include fd-ellipsis();

    font-family: var(--sapFontFamily);
    font-size: var(--sapFontSize);
  }

  .#{$block}__checkbox-label {
    padding: 0;
  }

  // MODIFIERS

  &--compact {
    .#{$block}__content {
      height: $fd-tree-item-height-compact;
    }

    .#{$block}__expander {
      width: $fd-tree-expander-width-compact;
      height: $fd-tree-expander-height-compact;
      font-size: 0.75rem;
    }
  }

  &--independent-selection {
    .#{$block}__form-item {
      margin-left: $fd-tree-checkbox-margin-left;

      @include fd-rtl() {
        margin-left: 0;
        margin-right: $fd-tree-checkbox-margin-left;
      }
    }

    &.#{$block}--compact {
      .#{$block}__form-item {
        margin-left: $fd-tree-checkbox-margin-left-compact;

        @include fd-rtl() {
          margin-left: 0;
          margin-right: $fd-tree-checkbox-margin-left-compact;
        }
      }
    }
  }

  &--dependent-selection {
    .#{$block}__form-item {
      margin-right: $fd-tree-checkbox-margin-right;

      @include fd-rtl() {
        margin-right: 0;
        margin-left: $fd-tree-checkbox-margin-right;
      }
    }

    &.#{$block}--compact {
      .#{$block}__form-item {
        margin-right: $fd-tree-checkbox-margin-right-compact;

        @include fd-rtl() {
          margin-right: 0;
          margin-left: $fd-tree-checkbox-margin-right-compact;
        }
      }
    }
  }
}
